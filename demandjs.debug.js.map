{"version":3,"sources":["demand.js"],"names":[],"mappings":"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","file":"demandjs.debug.js","sourcesContent":["/** @preserve DemandJS - v.1.0.0-rc.5\n *\n * https://github.com/hannasm/demandjs\n *\n **/\n(function (ctx) {\n  class DemandJS {\n    observeMutation(mutations) {\n      for (var mutation of mutations) {\n        if (mutation.type !== 'childList') { continue; }\n        for (var added of mutation.addedNodes) {\n          // haven't identified why this happens, maybe document.createElement()?\n          if (!added.parentNode) { continue; }\n          this.checkAdditionRecursive(added);\n        }\n      }\n    }\n    checkAdditionRecursive(added) {\n      if (this.observed.has(added)) { return; }\n      this.observed.set(added, true);\n\n      var res = this.isTargetMatch(added);\n      if (!res.loaded) {\n        if (res.isScript && res.injecting) {\n          this.injectedScript(added, res.injecting);\n          return;\n        } else if (res.isMatch) {\n          this.observeTarget(added);\n          return;\n        }\n      } \n\n      if(added.children) {\n        // modifying collectino while enumerating it leads to bad things so we need to make a copy \n        // before we do anything else with the children here\n        let children = Array.prototype.slice.call(added.children);\n        for (var child of children) {\n          this.checkAdditionRecursive(child);\n        }\n      }\n    }\n    observeIntersection(intersections) {\n      for (var intersect of intersections) {\n        if (!intersect.isIntersecting || intersect.intersectionRatio <= 0) { continue; }\n        let reg = this.phRegistry.get(intersect.target);\n        if (reg === undefined || reg.loading) { continue; }\n        reg.loading = true;\n        this.beginLoad(reg);   \n      }\n    }\n    beginLoad(target) {\n      var {target, registration} = this.resolveTarget(target);\n      if (registration.extraData.shouldInjectLink) {\n        let url = registration.extraData.href;\n\n        let onLoadBegin = this.selectByDemandClass(\n            target, this.options.onLoadBegin,\n            this.options.demandClassAttribute,\n            this.options.defaultDemandClass,\n            this.onLoadBegin);\n        onLoadBegin.call(this, target);\n\n        fetch(url).then(function (response) {\n          if (!response.ok) {\n            var error = new Error('Fetching \"' + url + '\" failed with ' + response.status + ' ' + response.statusText);\n            error.responseDetail = response;\n            throw error;\n          }\n          return response.text();\n        }).then(txt=>{\n          this.injectLink(registration, txt);\n        }).catch(ex=>{\n          this.handleError(registration, ex);\n        });\n      } else if (registration.extraData.shouldRestore) {\n        // setTimeout helps keep loading animations smooth\n        setTimeout(()=>this.restoreTarget(registration), 0);\n      } else {\n        throw 'Unknown load operation';\n      }\n    }\n    isResourceLoaded(target) {\n      return target.complete || false;\n    }\n    injectLink(target, txt) {\n      var {target, registration} = this.resolveTarget(target);\n\n      let previewLoading = this.selectByDemandClass(\n          target, this.options.previewLoading,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          false);\n      // if loading preview requested, never finish loading anything\n      if (previewLoading) { return; }\n\n      let previewFailure = this.selectByDemandClass(\n          target, this.options.previewFailure,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          false);\n      // if error preview requested, treat load success as load errors\n      if (previewFailure) {\n        this.handleError(target, new Error('found failure preview in options'));\n        return;\n      }\n\n      var type = registration.extraData.type;\n      if (type in this.options.linkHandler) {\n        var handler = this.options.linkHandler[type];\n        handler(target, txt);\n      } else {\n        throw 'Unknown link demand with content type: ' + type;\n      }\n      this.processSuccess(registration);\n    }\n    injectedScript(bc, injecting) {\n      let localScriptId = injecting.id;\n      let codePromise = Promise.resolve(bc.innerHTML);\n      if ('src' in bc && !(!(bc.src))) {\n        codePromise = fetch(bc.src).then(response=>{\n          if (!response.ok) {\n            throw Error(response.status + '_' + response.statusText);\n          }\n          return response.text();\n        });\n        localScriptId = bc.src + '#' + localScriptId;\n      }\n      codePromise.then(code=>{\n        this.injectScript(bc, injecting.href + '.demand[' + localScriptId + '].js', code);\n      });\n    }\n    injectScript(target, id, code) {\n      var oldDw = document.write;\n      var content = '';\n      document.write = c=>content += c;\n\n      var codeToExecute = new Function(code + \"\\n\" + '//@ sourceURL=' + id);\n      codeToExecute();\n     \n      if (content !== '') { \n        this.injectHtml(target, '<body>' + content + '</body>');\n      }\n\n      document.write = oldDw;\n    }\n    injectHtml(target, txt) {\n      var root = document.createElement('html');\n      root.innerHTML = txt;\n      var bodies = root.getElementsByTagName('body');\n      let injectionId = 1;\n      bodies = Array.prototype.slice.call(bodies);\n      for (var body of bodies) {\n        var clds = Array.prototype.slice.call(body.children);\n        for (var bc of clds) {\n          this.injecting.set(bc, {\n            href: target.href,\n            id: injectionId \n          });\n          injectionId += 1;\n          target.parentNode.insertBefore(bc, target);\n        }\n      }\n    }\n    processSuccess(target) {\n      var {target, registration} = this.resolveTarget(target);\n\n      let previewLoading = this.selectByDemandClass(\n          target, this.options.previewLoading,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          false);\n      // if loading preview requested, never finish loading anything\n      if (previewLoading) { return; }\n\n      let previewFailure = this.selectByDemandClass(\n          target, this.options.previewFailure,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          false);\n      // if error preview requested, treat load success as load errors\n      if (previewFailure) {\n        this.handleError(target, new Error('found failure preview in options'));\n        return;\n      }\n\n      // iframe load event being triggered twice\n      if (!registration) { return; }\n\n      if (registration.extraData.insertToLoad) {\n        target.style.display = registration.extraData.display;\n      }\n\n      let first = this.options.shouldInsertOnLoad(registration.target);\n      for (var placeholder of registration.placeholders) {\n        if (first) {\n          first = false;\n          placeholder.parentNode.insertBefore(registration.target, placeholder);\n        }\n        this.cleanupPlaceholder(placeholder);\n      }\n      this.cleanupRegistrationTarget(registration);\n\n      let onLoadSuccess = this.selectByDemandClass(\n          target, this.options.onLoadSuccess,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          this.onLoadSuccess);\n      onLoadSuccess.call(this, target);\n      let onLoadComplete = this.selectByDemandClass(\n          target, this.options.onLoadComplete,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          this.onLoadComplete);\n      onLoadComplete.call(this, target);\n    }\n    cleanupPlaceholder(placeholder) {\n        this.intersection.unobserve(placeholder);\n        placeholder.parentNode.removeChild(placeholder);\n        this.phRegistry.delete(placeholder);\n    }\n    cleanupRegistrationTarget(registration) {\n      this.intersection.unobserve(registration.target); // this only necesarry when we didnt remove the item\n      this.phRegistry.delete(registration.target);\n      this.loaded.set(registration.target, true);\n    }\n    handleError(target, ex) {\n      var {target, registration} = this.resolveTarget(target);\n\n      // error event being triggered twice\n      if (!registration) { return; }\n\n      if (!(ex && ex.stack && ex.message))  {\n        if (!ex) {\n          ex = new Error(\"No error was provided on load\");\n        } else {\n          ex = new Error(ex);\n        }\n      }\n      let onLoadFailure = this.selectByDemandClass(\n          target, this.options.onLoadFailure,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          this.onLoadFailure);\n\n      if (registration.extraData.insertToLoad) {\n        target.style.display = registration.extraData.display;\n      }\n\n      let first = true;\n      for (var placeholder of registration.placeholders) {\n        if (first) {\n          first = false;\n          \n          if (!target.parentNode || registration.extraData.insertToLoad) {\n            placeholder.parentNode.insertBefore(target, placeholder);\n          }\n\n          onLoadFailure.call(this, target, ex);\n        }\n        this.cleanupPlaceholder(placeholder);\n      }\n      if (first) {\n        onLoadFailure.call(this, target, ex);\n      }\n\n      this.cleanupRegistrationTarget(registration);\n      let onLoadComplete = this.selectByDemandClass(\n          target, this.options.onLoadComplete,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          this.onLoadComplete);\n      onLoadComplete.call(this, target);\n    }\n    onLoadBegin(t) {\n      //  nothing to do here\n    }\n    onLoadSuccess(target) {\n      //  nothing to do here\n    }\n    onLoadComplete(target) {\n      //  nothing to do here\n    }\n    onLoadFailure(target, ex) {\n        var createFailureNode = this.selectByDemandClass(\n            target, this.options.createFailureNode,\n            this.options.demandClassAttribute,\n            this.options.defaultDemandClass,\n            this.createFailureNode);\n        var errorUI = createFailureNode.call(this, target, ex);\n        errorUI = Array.prototype.slice.call(errorUI);\n        for (var eui of errorUI) {\n          // register placeholders so if they contain media we dont try to demand load them...\n          this.loaded.set(eui, true); \n\n          target.parentNode.insertBefore(eui, target);\n        }\n        if (this.options.shouldRemove(target)) {\n          target.parentNode.removeChild(target);\n        }\n    }\n    selectByDemandClass(t, data, attr, defaultKey, defaultData) {\n      if (!data) { return defaultData; }\n      if (typeof data === 'object') {\n        let key = defaultKey;\n        if (t.hasAttribute(attr)) { key = t.getAttribute(attr); }\n        do {\n          if (key in data) {\n            data = data[key];\n            break;\n          } else if (key === defaultKey) {\n            data = defaultData;\n            break;\n          }\n          key = defaultKey;\n        } while (true);\n      } \n\n      return data;\n    }\n    createFailureNode(t,ex) {\n      var ele = document.createElement('div');\n\n      let html = this.selectByDemandClass(t, \n          this.options.failureHtml, \n          this.options.demandClassAttribute, \n          this.options.defaultDemandClass, \n          this.defaultFailureHtml);\n      ele.innerHTML = html;\n\n      return ele.childNodes;\n    }\n    createLoadingNode(t) {\n      var ele = document.createElement('div');\n      \n      let html = this.selectByDemandClass(t, \n          this.options.loadingHtml, \n          this.options.demandClassAttribute, \n          this.options.defaultDemandClass, \n          this.defaultLoadingHtml);\n      ele.innerHTML = html;\n\n      return ele.childNodes;\n    }\n    registerPlaceholder(node, target, placeholders, extraData) {\n      var result = {\n        isRegistration: true,\n        target: target,\n        node: node,\n        placeholders: placeholders,\n        extraData: extraData,\n        loading: false\n      };\n      this.phRegistry.set(node, result);\n      return result;\n    }\n    resolveTarget(target) {\n      var registration = target;\n      if (!('isRegistration' in target) || !(target.isRegistration)) {\n        registration = this.phRegistry.get(target);\n      } else { \n        target = registration.target;\n      }\n      return {\n        target: target,\n        registration: registration\n      };\n    }\n    restoreTarget(target) {\n      var {target, registration} = this.resolveTarget(target);\n      var extraData = registration.extraData;\n      registration.loading = true;\n\n      let onLoadBegin = this.selectByDemandClass(\n          target, this.options.onLoadBegin,\n          this.options.demandClassAttribute,\n          this.options.defaultDemandClass,\n          this.onLoadBegin);\n      onLoadBegin.call(this, target);\n\n      this._restoreTargetInternal(target, extraData);\n\n      if (!extraData.canLoad) {\n        this.processSuccess(registration);\n      }\n    }\n    _restoreTargetInternal(target, extraData) {\n      if (extraData.hasSrcset) {\n        target.setAttribute('srcset', extraData.srcset);\n      }\n      if (extraData.hasSizes) {\n        target.setAttribute('sizes', extraData.sizes);\n      }\n      if (extraData.hasSrc) {\n        target.setAttribute('src', extraData.src);\n      }\n      if (extraData.children.length > 0) {\n        for (var i = 0; i < extraData.children.length; i++) {\n          var childData = extraData.children[i];\n          this._restoreTargetInternal(childData.target, childData);\n        }\n      }\n\n      if (extraData.insertToLoad) {\n        target.style.display = 'none';\n        this.loaded.set(target);\n        document.body.appendChild(target);\n      }\n    }\n    captureTarget(target, targetRoot) {\n      var store = {\n        'target': target,\n        'hasSrc':  target.hasAttribute('src'),\n        'src':  target.getAttribute('src'),\n        'hasSrcset': target.hasAttribute('srcset'),\n        'srcset': target.getAttribute('srcset'),\n        'hasSizes': target.hasAttribute('sizes'),\n        'sizes': target.getAttribute('sizes'),\n        'isLink': ('tagName' in target) && (target.tagName.match(/link/i)),\n        'insertToLoad': ('tagName' in target) && (target.tagName.match(/iframe/i)),\n        'hasHref': target.hasAttribute('href'),\n        'href': target.getAttribute('href'),\n        'hasType': target.hasAttribute('type'),\n        'type': target.getAttribute('type'),\n        'hasDisplay': target.style && target.style.display,\n        'display': target.style.display || '',\n        'children': [],\n        'shouldRestore': false,\n        'canLoad': false,\n        'shouldInjectLink': false\n      };\n      if (store.hasSrc) {\n        target.removeAttribute('src');\n      }\n      if (store.hasSrcset) {\n        target.removeAttribute('srcset');\n      }\n      if (store.hasSizes) {\n        target.removeAttribute('sizes');\n      }\n\n      if (store.isLink && store.hasHref) {\n        store.shouldInjectLink = true;\n        if (!store.hasType) {\n          store.type = 'text/html';\n        }\n      }\n\n\n      // We do not care about load events of child elements\n      if ((store.hasSrc || store.hasSrcset) && target === targetRoot) {\n        store.shouldRestore = true;\n        store.canLoad = true;\n        \n       if(  ('tagName' in target) && target.tagName.match(/video|audio/i)) {\n        target.addEventListener('loadedmetadata', evt=>this.processSuccess(targetRoot));\n        target.addEventListener('loadeddata', evt=>this.processSuccess(targetRoot));\n       } else {\n        target.addEventListener('load', evt=>this.processSuccess(targetRoot));\n       }\n\n        if (store.hasSrcset && store.hasSrc) {\n          target.addEventListener('error', evt=>{\n            this.handleError(targetRoot, new Error('Loading for srcset and src failed (' + store.srcset + ')(' + store.src + ')'))\n          });\n        } else if (store.hasSrcset) {\n          target.addEventListener('error', evt=>{\n            this.handleError(targetRoot, new Error('Loading for srcset failed (' + store.srcset + ')'))\n          });\n        } else if (store.hasSrc) {\n          target.addEventListener('error', evt=>{\n            this.handleError(targetRoot, new Error('Loading for src failed (' + store.src + ')'))\n          });\n        } else {\n          target.addEventListener('error', evt=>{\n            this.handleError(targetRoot, new Error('Loading srced element failed (FALLBACK ERROR MSG)'))\n          });\n        }\n      }\n\n      if ('tagName' in target && target.tagName.match(/picture|video|audio/i)) {\n        if (target === targetRoot) {\n          store.shouldRestore = true;\n        }\n        for (var i = 0; i < target.children.length; i++) {\n          var child = target.children[i];\n          var desc = this.captureTarget(child);\n          desc.index = i;\n          store.children.push(desc);\n        }\n      }\n\n      return store;\n    }\n    isContextExcluded(target) {\n      if (!target) { return false; }\n      if (!('parentNode' in target)) { return false; }\n      var parent = target.parentNode;\n      if (!parent) { return false; }\n      if (!('tagName' in parent)) { return false; }\n      if (parent.tagName.match(/picture|video|audio/i)) { return true; }\n\n      // need to recurse up for cases like video with embedded html as a fallback\n      return this.isContextExcluded(parent);\n    }\n    observeTarget(target) {\n      if (this.isResourceLoaded(target)) {\n        // do nothing, its already fully loaded\n      } else if (this.isContextExcluded(target)) { \n        // do nothing, another element should take care of it\n      } else {\n        var store = this.captureTarget(target, target);\n\n        var createLoadingNode = this.selectByDemandClass(\n            target, this.options.createLoadingNode,\n            this.options.demandClassAttribute,\n            this.options.defaultDemandClass,\n            this.createLoadingNode);\n        var placeholders = createLoadingNode.call(this, target);\n        placeholders = Array.prototype.slice.call(placeholders);\n\n        for (var placeholder of placeholders) {\n          this.registerPlaceholder(placeholder, target, placeholders, store);\n          // register placeholders so if they contain media we dont try to demand load them...\n          this.loaded.set(placeholder, true); \n          target.parentNode.insertBefore(placeholder, target);\n          this.intersection.observe(placeholder);\n        }\n        this.registerPlaceholder(target, target, placeholders, store);\n        if (this.options.shouldRemove(target)) {\n          target.parentNode.removeChild(target);\n        } else {\n          this.intersection.observe(target);\n        }\n      }\n    }\n    observeTargets(targets) {\n      for (var target of targets) {\n        this.observeTarget(target);\n      }\n    }\n    isLoadedRecursive(target, injecting) {\n      if (this.loaded.has(target)) { return { loaded: true, injecting: injecting || this.injecting.get(target) }; }\n      // we cant be injecting an element and loading it simultaneously\n      if (!injecting && target.parentNode) {\n       return this.isLoadedRecursive(target.parentNode, injecting || this.injecting.get(target));\n      }\n     return { loaded: false, injecting: injecting || this.injecting.get(target) };\n    }\n    isScript(bc) {\n      return !!('tagName' in bc && bc.tagName.match(/^script$/i));\n    }\n    isTargetMatch(target) {\n      var isMatch = 'matches' in target && target.matches(this.options.selector);\n      isMatch = isMatch && !(this.options.ignoreSelector && target.matches(this.options.ignoreSelector));\n\n      var isScript = this.isScript(target);\n\n      if (!isMatch && !isScript) {\n        return { isMatch: isMatch, isScript: isScript, loaded: false, injecting: false }; \n      }\n     \n      var result = this.isLoadedRecursive(target, false);\n      result.isMatch = isMatch;\n      result.isScript = isScript;\n      return result;\n    }\n    queryTargets() {\n      let result = [];\n      for (var node of document.querySelectorAll(this.options.selector)) {\n        if (this.options.ignoreSelector && 'matches' in node && node.matches(this.options.ignoreSelector)) { continue; }\n        result.push(node);\n      }\n      return result;\n    }\n    shouldRemove(t) {\n      return !('tagName' in t) || !(t.tagName.match(/link/i)); \n    }\n    constructor(options) {\n      this.phRegistry = new WeakMap();\n      this.loaded = new WeakMap();\n      this.injecting = new WeakMap();\n      this.observed = new WeakMap();\n\n      let newHandlers = {};\n      if (options && 'linkHandler' in options) {\n        newHandlers = options.linkHandler;\n        delete options.linkHandler;\n      }\n\n      this.defaultLoadingHtml = '<div style=\"width:100%;height:100%\">Loading In Progress</div>';\n      this.defaultFailureHtml = '<div style=\"background-color:#F00;color:#FFF;font-size:20pt;\">ERROR</div>';\n\n      this.options = Object.assign({\n        previewLoading: false,\n        previewFailure: false,\n        demandClassAttribute: 'data-demand',\n        defaultDemandClass: 'default',\n        loadingHtml: this.defaultLoadingHtml,\n        failureHtml: this.defaultFailureHtml,\n        createLoadingNode: t=>this.createLoadingNode(t),\n        createFailureNode: (t,ex)=>this.createFailureNode(t, ex),\n        shouldRemove: t=>!('tagName' in t) || !(t.tagName.match(/link/i)),\n        shouldInsertOnLoad: t=>this.options.shouldRemove(t),\n        selector: 'img,video,picture,iframe,link.demand',\n        ignoreSelector: '.nodemand',\n        rootMargin: '48px',\n        threshold: 0.001,\n        onLoadBegin: t=>this.onLoadBegin(t),\n        onLoadSuccess: t=>this.onLoadSuccess(t),\n        onLoadFailure: (t,e)=>this.onLoadFailure(t,e),\n        onLoadComplete: t=>this.onLoadComplete(t),\n        linkHandler: {\n          'text/html': (t,c)=>this.injectHtml(t,c),\n          'application/xhtml+xml': (t,c)=>this.injectHtml(t,c)\n        }\n      }, options);\n      this.options.linkHandler = Object.assign(this.options.linkHandler, newHandlers);\n\n      this.mutation = new MutationObserver((a,b)=>this.observeMutation(a,b));\n      this.mutationOptions = {\n        childList: true,\n        subtree: true\n      };\n\n      this.intersectionOptions = {\n        root: null,\n        rootMargin:this.options.rootMargin,\n        threshold:this.options.threshold \n      };\n      this.intersection = new IntersectionObserver( (a,b)=>this.observeIntersection(a,b), this.intersectionOptions);\n  \n      var targets = this.queryTargets();\n      this.observeTargets(targets);\n      this.mutation.observe(document.body, this.mutationOptions);\n    }\n  }\n\n  ctx['DemandJS'] = DemandJS;\n})(window);\n/** @license MIT License\n\nCopyright (c) 2017 Sean Hanna\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n */\n"]}