<html>
  <head>
    <link rel='stylesheet' type="text/css" href='base.css' />
    <script src='imagelist.js'></script>
  </head>
  <body>
    <script type="text/javascript">
      for (var i = 0; i < window.test_images.length; i++) {i
        var arr = window.test_images;
        if (i%2==1) {
          arr = window.error_images;
        }
				var cls = '';
				if (i % 4 == 1) {
					cls = " class='showErrorMessage'";
				}
        document.write('<img src="' + arr[i] + '"' + cls + ' /><br/>');
      }
    </script>
    <style type='text/css'>
    .errorMessage {
      background-color: #F00;
      color:#FFF;
      width:100%;
    }
    </style>
    <script src="../demandjs.debug.js"></script>
    <script type="text/javascript" language="javascript">
			var options = {
				createFailureNode: function(target,error) {
					if (target.classList.contains('showErrorMessage')) {
						var result = document.createElement('div');
						result.innerHTML = '<div class="errorMessage">Loading failed with error: </div>';
						result.children[0].appendChild(document.createTextNode(error.message));
						return result.children;
					} else {
						return this.createFailureNode();
					}
				}
			};

      var djs = new DemandJS(options);
    </script>
  </body>
</html>
