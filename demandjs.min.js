var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,a){c!=Array.prototype&&c!=Object.prototype&&(c[f]=a.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var f=0;return $jscomp.iteratorPrototype(function(){return f<c.length?{done:!1,value:c[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();var f=c[Symbol.iterator];return f?f.call(c):$jscomp.arrayIterator(c)};
$jscomp.polyfill=function(c,f,a,d){if(f){a=$jscomp.global;c=c.split(".");for(d=0;d<c.length-1;d++){var b=c[d];b in a||(a[b]={});a=a[b]}c=c[c.length-1];d=a[c];f=f(d);f!=d&&null!=f&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:f})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(c){function f(){this.batch_=null}function a(e){return e instanceof b?e:new b(function(a,b){a(e)})}if(c&&!$jscomp.FORCE_POLYFILL_PROMISE)return c;f.prototype.asyncExecute=function(e){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(e);return this};f.prototype.asyncExecuteBatch_=function(){var e=this;this.asyncExecuteFunction(function(){e.executeBatch_()})};var d=$jscomp.global.setTimeout;f.prototype.asyncExecuteFunction=function(e){d(e,
0)};f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var a=0;a<e.length;++a){var b=e[a];delete e[a];try{b()}catch(g){this.asyncThrow_(g)}}}this.batch_=null};f.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var b=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var e=this.createResolveAndReject_();try{a(e.resolve,e.reject)}catch(h){e.reject(h)}};b.prototype.createResolveAndReject_=
function(){function a(a){return function(e){d||(d=!0,a.call(b,e))}}var b=this,d=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};b.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var e=null!=a;break a;case "function":e=!0;break a;default:e=!1}e?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};b.prototype.resolveToNonPromiseObj_=function(a){var e=
void 0;try{e=a.then}catch(h){this.reject_(h);return}"function"==typeof e?this.settleSameAsThenable_(e,a):this.fulfill_(a)};b.prototype.reject_=function(a){this.settle_(2,a)};b.prototype.fulfill_=function(a){this.settle_(1,a)};b.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};b.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var k=new f;b.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};b.prototype.settleSameAsThenable_=function(a,b){var e=this.createResolveAndReject_();try{a.call(b,e.resolve,e.reject)}catch(g){e.reject(g)}};b.prototype.then=function(a,d){function e(a,b){return"function"==typeof a?function(b){try{c(a(b))}catch(u){l(u)}}:b}var c,l,k=new b(function(a,
b){c=a;l=b});this.callWhenSettled_(e(a,c),e(d,l));return k};b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.callWhenSettled_=function(a,b){function e(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?k.asyncExecute(e):this.onSettledCallbacks_.push(function(){k.asyncExecute(e)})};b.resolve=a;b.reject=function(a){return new b(function(b,e){e(a)})};b.race=function(e){return new b(function(b,
d){for(var c=$jscomp.makeIterator(e),l=c.next();!l.done;l=c.next())a(l.value).callWhenSettled_(b,d)})};b.all=function(e){var d=$jscomp.makeIterator(e),c=d.next();return c.done?a([]):new b(function(b,e){function l(a){return function(e){k[a]=e;f--;0==f&&b(k)}}var k=[],f=0;do k.push(void 0),f++,a(c.value).callWhenSettled_(l(k.length-1),e),c=d.next();while(!c.done)})};return b},"es6","es3");$jscomp.owns=function(c,f){return Object.prototype.hasOwnProperty.call(c,f)};
$jscomp.polyfill("WeakMap",function(c){function f(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function a(a){var b=Object[a];b&&(Object[a]=function(a){f(a);return b(a)})}if(function(){if(!c||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),d=new c([[a,2],[b,3]]);if(2!=d.get(a)||3!=d.get(b))return!1;d.delete(a);d.set(b,4);return!d.has(a)&&4==d.get(b)}catch(g){return!1}}())return c;var d="$jscomp_hidden_"+Math.random().toString().substring(2);a("freeze");a("preventExtensions");
a("seal");var b=0,k=function(a){this.id_=(b+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}};k.prototype.set=function(a,b){f(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=b;return this};k.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};k.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};k.prototype.delete=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return k},"es6","es3");$jscomp.polyfill("Object.assign",function(c){return c?c:function(c,a){for(var d=1;d<arguments.length;d++){var b=arguments[d];if(b)for(var k in b)$jscomp.owns(b,k)&&(c[k]=b[k])}return c}},"es6","es3");
var _createClass=function(){function c(c,a){for(var d=0;d<a.length;d++){var b=a[d];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(c,b.key,b)}}return function(f,a,d){a&&c(f.prototype,a);d&&c(f,d);return f}}();function _classCallCheck(c,f){if(!(c instanceof f))throw new TypeError("Cannot call a class as a function");}
(function(c){c=function(){function c(a){var d=this;_classCallCheck(this,c);this.phRegistry=new WeakMap;this.options=Object.assign({pendingHTML:'<div style="width:100%;height:100%">Loading In Progress</div>',errorHTML:'<div style="background-color:#F00;color:#FFF;font-size:20pt;">ERROR</div>',createPlaceholder:function(a){return d.createPlaceholder()},createErrorNode:function(a){return d.createErrorNode()},shouldRemove:function(a){return!("tagName"in a)||!a.tagName.match(/link/i)},shouldInsertOnLoad:function(a){return d.options.shouldRemove(a)},
selector:"img,video,iframe,link.demand"},a);this.mutation=new MutationObserver(function(a,c){return d.observeMutation(a,c)});this.mutationOptions={childList:!0,subtree:!0};this.intersectionOptions={root:null,rootMargin:"48px",threshold:0};this.intersection=new IntersectionObserver(function(a,c){return d.observeIntersection(a,c)},this.intersectionOptions);this.observeTargets(this.queryTargets());this.mutation.observe(document.body,this.mutationOptions)}_createClass(c,[{key:"observeMutation",value:function(a){var d=
!0,b=!1,c=void 0;try{for(var e=a[Symbol.iterator](),f;!(d=(f=e.next()).done);d=!0){var h=f.value;if("childList"===h.type){a=!0;var g=!1,m=void 0;try{for(var p=h.addedNodes[Symbol.iterator](),r;!(a=(r=p.next()).done);a=!0){var t=r.value;this.isTargetMatch(t)&&this.observeTarget(t)}}catch(n){g=!0,m=n}finally{try{!a&&p.return&&p.return()}finally{if(g)throw m;}}}}}catch(n){b=!0,c=n}finally{try{!d&&e.return&&e.return()}finally{if(b)throw c;}}}},{key:"observeIntersection",value:function(a){var d=!0,b=!1,
c=void 0;try{for(var e=a[Symbol.iterator](),f;!(d=(f=e.next()).done);d=!0){var h=f.value;if(h.isIntersecting){var g=this.phRegistry.get(h.target);void 0===g||g.loading||(g.loading=!0,this.beginLoad(g))}}}catch(m){b=!0,c=m}finally{try{!d&&e.return&&e.return()}finally{if(b)throw c;}}}},{key:"beginLoad",value:function(a){var d=this;if(a.extraData.isLink&&a.extraData.hasHref)fetch(a.extraData.href).then(function(a){if(!a.ok)throw Error(a.status+"_"+a.statusText);return a.text()}).then(function(b){d.injectLink(a.target,
b)}).catch(function(b){d.onLoadError(a,b)});else if(a.extraData.hasSrc)a.target.addEventListener("load",function(b){return d.onLoadComplete(a)}),a.target.addEventListener("error",function(b){return d.onLoadError(a,b)}),setTimeout(function(){return a.target.setAttribute("src",a.extraData.src)},0);else throw"Unknown load operation";}},{key:"isLoaded",value:function(a){return a.complete||!1}},{key:"injectLink",value:function(a,d){if(a.href.match(/\.html$/i)){var b=this.phRegistry.get(a);this.injectHtml(a,
d);this.onLoadComplete(b)}else throw Error("Not implemented link injection with url "+a.href);}},{key:"injectScript",value:function(a,d,b){var c=document.write,e="";document.write=function(a){return e+=a};(new Function(b+"\n//@ sourceURL="+d))();""!==e&&this.injectHtml(a,"<body>"+e+"</body>");document.write=c}},{key:"injectHtml",value:function(a,d){var b=this,c=document.createElement("html");c.innerHTML=d;var e=c.getElementsByTagName("body"),f=1;d=!0;c=!1;var h=void 0;try{for(var g=e[Symbol.iterator](),
m;!(d=(m=g.next()).done);d=!0){var p=m.value;e=!0;var r=!1,t=void 0;try{for(var n=p.children[Symbol.iterator](),u;!(e=(u=n.next()).done);e=!0){var q=u.value;"tagName"in q&&q.tagName.match(/script/i)?function(){var d=f;f+=1;var c=Promise.resolve(q.innerHTML);"src"in q&&q.src&&(c=fetch(q.src).then(function(a){if(!a.ok)throw Error(a.status+"_"+a.statusText);return a.text()}));c.then(function(c){b.injectScript(a,a.href+".inline["+d+"].js",c)})}():a.parentNode.insertBefore(q,a)}}catch(v){r=!0,t=v}finally{try{!e&&
n.return&&n.return()}finally{if(r)throw t;}}}}catch(v){c=!0,h=v}finally{try{!d&&g.return&&g.return()}finally{if(c)throw h;}}}},{key:"onLoadComplete",value:function(a){var d=this.options.shouldInsertOnLoad(a.target),b=!0,c=!1,e=void 0;try{for(var f=a.placeholders[Symbol.iterator](),h;!(b=(h=f.next()).done);b=!0){var g=h.value;d&&(d=!1,g.parentNode.insertBefore(a.target,g));this.cleanupPlaceholder(g)}}catch(m){c=!0,e=m}finally{try{!b&&f.return&&f.return()}finally{if(c)throw e;}}this.cleanupRegistrationTarget(a)}},
{key:"cleanupPlaceholder",value:function(a){this.intersection.unobserve(a);a.parentNode.removeChild(a);this.phRegistry.delete(a)}},{key:"cleanupRegistrationTarget",value:function(a){this.intersection.unobserve(a.target);this.phRegistry.delete(a.target)}},{key:"onLoadError",value:function(a,d){var b=d=!0,c=!1,e=void 0;try{for(var f=a.placeholders[Symbol.iterator](),h;!(b=(h=f.next()).done);b=!0){var g=h.value;if(d){d=!1;var m=this.options.createErrorNode(a.target),p=!0,r=!1,t=void 0;try{for(var n=
m[Symbol.iterator](),u;!(p=(u=n.next()).done);p=!0)g.parentNode.insertBefore(u.value,g)}catch(q){r=!0,t=q}finally{try{!p&&n.return&&n.return()}finally{if(r)throw t;}}}this.cleanupPlaceholder(g)}}catch(q){c=!0,e=q}finally{try{!b&&f.return&&f.return()}finally{if(c)throw e;}}this.cleanupRegistrationTarget(a)}},{key:"createErrorNode",value:function(){var a=document.createElement("div");a.innerHTML=this.options.errorHTML;return Array.prototype.slice.call(a.childNodes)}},{key:"createPlaceholder",value:function(){var a=
document.createElement("div");a.innerHTML=this.options.pendingHTML;return Array.prototype.slice.call(a.childNodes)}},{key:"registerPlaceholder",value:function(a,d,b,c){this.phRegistry.set(a,{target:d,node:a,placeholders:b,extraData:c,loading:!1})}},{key:"observeTarget",value:function(a){if(!this.isLoaded(a)){var d={hasSrc:a.hasAttribute("src"),src:a.getAttribute("src"),isLink:"tagName"in a&&a.tagName.match(/link/i),hasHref:a.hasAttribute("href"),href:a.getAttribute("href")};d.hasSrc&&a.removeAttribute("src");
var b=this.options.createPlaceholder(a),c=!0,e=!1,f=void 0;try{for(var h=b[Symbol.iterator](),g;!(c=(g=h.next()).done);c=!0){var m=g.value;this.registerPlaceholder(m,a,b,d);a.parentNode.insertBefore(m,a);this.intersection.observe(m)}}catch(p){e=!0,f=p}finally{try{!c&&h.return&&h.return()}finally{if(e)throw f;}}this.registerPlaceholder(a,a,b,d);this.options.shouldRemove(a)?a.parentNode.removeChild(a):this.intersection.observe(a)}}},{key:"observeTargets",value:function(a){var c=!0,b=!1,f=void 0;try{for(var e=
a[Symbol.iterator](),l;!(c=(l=e.next()).done);c=!0)this.observeTarget(l.value)}catch(h){b=!0,f=h}finally{try{!c&&e.return&&e.return()}finally{if(b)throw f;}}}},{key:"isTargetMatch",value:function(a){return"matches"in a&&a.matches(this.options.selector)}},{key:"queryTargets",value:function(){var a=[],c=!0,b=!1,f=void 0;try{for(var e=document.querySelectorAll(this.options.selector)[Symbol.iterator](),l;!(c=(l=e.next()).done);c=!0)a.push(l.value)}catch(h){b=!0,f=h}finally{try{!c&&e.return&&e.return()}finally{if(b)throw f;
}}return a}},{key:"shouldRemove",value:function(a){return!("tagName"in a)||!a.tagName.match(/link/i)}}]);return c}();window.DemandJS=c})(window);
